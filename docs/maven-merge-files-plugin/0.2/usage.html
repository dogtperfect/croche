<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jun 24, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>maven-merge-file-plugin - Usage</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="croche" />
    <meta name="Date-Revision-yyyymmdd" content="20110624" />
    <meta http-equiv="Content-Language" content="en" />
        
  </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                maven-merge-file-plugin
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="publishDate">Last Published: 24 Jun 2011 08:50:01</span>
                  &nbsp;| <span id="projectVersion">Version: 0.2</span>
                      </div>
            <div class="xright">                    <a href="http://maven.apache.org/" class="externalLink" title="Maven 2">Maven 2</a>
              
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="plugin-info.html" title="Goals">Goals</a>
            </li>
                  <li class="none">
            <strong>Usage</strong>
          </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                        <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Usage<a name="Usage"></a></h2><div class="section"><h3>Configuring the plugin<a name="Configuring_the_plugin"></a></h3><p>To start using the plugin you will need to configure the repository location for the plugin.</p><div class="source"><pre>&lt;project&gt;
  ...
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;croche-releases&lt;/id&gt;
      &lt;url&gt;http://croche.googlecode.com/svn/repository/releases&lt;/url&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
  ...
&lt;/project&gt;</pre></div></div><div class="section"><h3>Merge Configuration<a name="Merge_Configuration"></a></h3><p>To configure the merged files you have to add one or more merges which represents the merge of a set of files into a single target file.</p><ul><li>Within each <b>merge</b> you should add a <b>targetFile</b> which is the location of the end result file where all files being merged are written to. This target file will be recreated each time the plugin is ran.</li><li>You will also need to add one or more <b>sourceDir</b> which is the directory where it should scan for files to merge. NOTE that it will scan into not just the source directory but also all of its subdirectories too. </li><li>You can optionally add one or more <b>include</b> which are the sub strings the file name must contain in order to be included in the files that get appended. If you do not specify any includes then it will append all files found in the source directories and their sub-directories.</li><li>If you want to add a separator to be added above each merged file then you can add a <b>separator</b>. In the separator 3 variables are supported: \n will translate into a line break in the output file, #{file.name} will be replaced with the name of the file that is being appended into the target file, #{parent.name} will be replaced with the directory name containing the file that is being appended into the target file.</li><li>You can control the order that files found are appended to the target file. To do this add the <b>nameContainsOrderings</b> configuration. Each <b>nameContainsOrdering</b> defines a substring that the file name must contain to group files in order relative to each other <b>nameContainsOrdering</b> in the list. Any found files that do not match any of the <b>nameContainsOrdering</b> will be added last. For example if your list of <b>nameContainsOrderings</b> contained intro, body and footer in that order then any files with intro in their name would be appended first, followed by any files with body in their name and finally followed by any files with footer in their name. Any files that had neither intro, body or footer in their name would be appended last.</li><li>The default encoding used to read and write the files is UTF-8 but if you want to change this then you can add the <b>encoding</b> element.</li></ul></div><div class="section"><h3>Basic Merge Configuration Example <a name="Basic_Merge_Configuration_Example"></a></h3><div class="source"><pre>&lt;project&gt;
  ...
 &lt;build&gt;
  &lt;plugins&gt;
   &lt;plugin&gt;
        &lt;groupId&gt;croche.maven&lt;/groupId&gt;
        &lt;artifactId&gt;maven-merge-file-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
                &lt;execution&gt;
                        &lt;id&gt;merge-release-notes&lt;/id&gt;
                        &lt;phase&gt;process-resources&lt;/phase&gt;
                        &lt;goals&gt;
                                &lt;goal&gt;merge&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                                &lt;merges&gt;
                                        &lt;merge&gt;
                                                &lt;targetFile&gt;docs/all-release-notes.txt&lt;/targetFile&gt;
                                                &lt;sourceDirs&gt;
                                                        &lt;sourceDir&gt;docs&lt;/sourceDir&gt;
                                                &lt;/sourceDirs&gt;
                                                &lt;includes&gt;
                                                        &lt;include&gt;release-notes.txt&lt;/include&gt;
                                                &lt;/includes&gt;
                                        &lt;/merge&gt;
                                &lt;/merges&gt;
                        &lt;/configuration&gt;
                &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;/plugin&gt;
   &lt;/plugins&gt;
 &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div><p>The example configuration above merges release notes files in the docs directory into a single release notes file all-release-notes.txt, for example if there were files called component1-release-notes.txt, component2-release-notes.txt, component3-release-notes.txt in this directory it would append them together.</p></div><div class="section"><h3>Detailed Merge Configuration Example <a name="Detailed_Merge_Configuration_Example"></a></h3><div class="source"><pre>&lt;project&gt;
  ...
 &lt;build&gt;
  &lt;plugins&gt;
   &lt;plugin&gt;
        &lt;groupId&gt;croche.maven&lt;/groupId&gt;
        &lt;artifactId&gt;maven-merge-file-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
                &lt;execution&gt;
                        &lt;id&gt;merge-sql&lt;/id&gt;
                        &lt;phase&gt;process-resources&lt;/phase&gt;
                        &lt;goals&gt;
                                &lt;goal&gt;merge&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                                &lt;merges&gt;
                                        &lt;merge&gt;
                                                &lt;targetFile&gt;database/install-all.sql&lt;/targetFile&gt;
                                                &lt;sourceDirs&gt;
                                                        &lt;sourceDir&gt;database&lt;/sourceDir&gt;
                                                &lt;/sourceDirs&gt;
                                                &lt;nameContainsOrderings&gt;
                                                        &lt;nameContainsOrdering&gt;recreate-schema.sql&lt;/nameContainsOrdering&gt;
                                                        &lt;nameContainsOrdering&gt;create-schema.sql&lt;/nameContainsOrdering&gt;
                                                        &lt;nameContainsOrdering&gt;schema-objects&lt;/nameContainsOrdering&gt;
                                                        &lt;nameContainsOrdering&gt;indices&lt;/nameContainsOrdering&gt;
                                                        &lt;nameContainsOrdering&gt;data&lt;/nameContainsOrdering&gt;
                                                &lt;/nameContainsOrderings&gt;
                                                &lt;includes&gt;
                                                        &lt;include&gt;.sql&lt;/include&gt;
                                                &lt;/includes&gt;
                                                &lt;separator&gt;-- ***** SQL File: #\{parent.name\}/#\{file.name\} *****\\n\\n&lt;/separator&gt;
                                                &lt;encoding&gt;UTF-8&lt;/encoding&gt;
                                        &lt;/merge&gt;
                                &lt;/merges&gt;
                        &lt;/configuration&gt;
                &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;/plugin&gt;
   &lt;/plugins&gt;
 &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div><p>The example configuration above merges any SQL files in the ${project.build.directory}/database and any of its subdirectories into a single SQL file ${project.build.directory}/database/install-all.sql. It would first append any files with recreate-schema.sql in their name, followed by create-schema.sql in their name, followed by schema-objects in their name, followed by indices in their name and finally followed by data in their name. It adds a SQL comment at the top of each appended file. I use this where I have several EAR projects that main their own SQL scripts for creating a schema that they use. Within each of these projects they have a script to drop/create the database schema, the objects (tables, views, functions, procedures), additional column indices, and some initial static data. The configuration above merges them into a single install SQL script that I can use to setup the database from scratch where I want the drop/create schema queries to run first, followed by the create tables, then the create indices and finally the static data inserts.</p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                    2011
                        <a href="http://code.google.com/p/croche/">Conor Roche</a>.
            All Rights Reserved.      
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
